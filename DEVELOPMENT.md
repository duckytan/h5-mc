# å¼€å‘æŒ‡å—

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

MC-H5 æ˜¯ä¸€ä¸ªåŸºäº WebGL å’Œ Three.js å¼€å‘çš„æµè§ˆå™¨ç‰ˆæˆ‘çš„ä¸–ç•Œæ¸¸æˆã€‚

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ ¸å¿ƒæ¨¡å—

#### 1. VoxelWorld (ä½“ç´ ä¸–ç•Œ)
- **æ–‡ä»¶**: `src/core/VoxelWorld.ts`
- **èŒè´£**: ç®¡ç†æ‰€æœ‰ä½“ç´ æ•°æ®
- **åŠŸèƒ½**:
  - è®¾ç½®å’Œè·å–ä½“ç´ 
  - åˆ†å—å­˜å‚¨ä¼˜åŒ–
  - å†…å­˜ç®¡ç†

```typescript
// ä½¿ç”¨ç¤ºä¾‹
const world = new VoxelWorld();
world.setVoxel(10, 20, 30, BlockType.GRASS);
const type = world.getVoxel(10, 20, 30);
```

#### 2. ChunkManager (åˆ†å—ç®¡ç†)
- **æ–‡ä»¶**: `src/core/ChunkManager.ts`
- **èŒè´£**: ç”Ÿæˆå’Œç®¡ç†3DåŒºå—
- **åŠŸèƒ½**:
  - é¢å‰”é™¤ä¼˜åŒ–
  - å‡ ä½•ä½“ç”Ÿæˆ
  - æ€§èƒ½ä¼˜åŒ–

```typescript
// ç”ŸæˆåŒºå—
const chunk = chunkManager.generateChunk(0, 0, 0);
scene.add(chunk);
```

#### 3. PlayerController (ç©å®¶æ§åˆ¶)
- **æ–‡ä»¶**: `src/gameplay/PlayerController.ts`
- **èŒè´£**: å¤„ç†ç©å®¶ç§»åŠ¨å’Œè§†è§’
- **åŠŸèƒ½**:
  - ç¬¬ä¸€äººç§°æ§åˆ¶
  - ç‰©ç†æ¨¡æ‹Ÿ
  - ç¢°æ’æ£€æµ‹

#### 4. BlockInteraction (æ–¹å—äº¤äº’)
- **æ–‡ä»¶**: `src/gameplay/BlockInteraction.ts`
- **èŒè´£**: å¤„ç†æ–¹å—çš„æ”¾ç½®å’Œç ´å
- **åŠŸèƒ½**:
  - å°„çº¿æ£€æµ‹
  - æ–¹å—æ“ä½œ
  - åŒºå—æ›´æ–°

#### 5. TerrainGenerator (åœ°å½¢ç”Ÿæˆ)
- **æ–‡ä»¶**: `src/world/TerrainGenerator.ts`
- **èŒè´£**: ç”Ÿæˆæ¸¸æˆä¸–ç•Œ
- **åŠŸèƒ½**:
  - åœ°å½¢ç®—æ³•
  - ç”Ÿç‰©ç¾¤ç³»
  - ç»“æ„ç”Ÿæˆ

## ğŸ”§ å¼€å‘æµç¨‹

### æ·»åŠ æ–°æ–¹å—ç±»å‹

1. åœ¨ `VoxelWorld.ts` ä¸­æ·»åŠ æšä¸¾å€¼ï¼š
```typescript
export enum BlockType {
  AIR = 0,
  GRASS = 1,
  DIRT = 2,
  STONE = 3,
  // æ·»åŠ æ–°ç±»å‹
  NEW_BLOCK = 8
}
```

2. åœ¨ `MaterialManager.ts` ä¸­æ·»åŠ æè´¨ï¼š
```typescript
this.materials.set(BlockType.NEW_BLOCK, new THREE.MeshLambertMaterial({
  color: 0xff0000
}));
```

3. åœ¨ `GameUI.ts` ä¸­æ·»åŠ åˆ°æ–¹å—é€‰æ‹©å™¨ï¼š
```typescript
{ type: 8, name: 'æ–°æ–¹å—' }
```

### ä¿®æ”¹åœ°å½¢ç”Ÿæˆ

åœ¨ `TerrainGenerator.ts` ä¸­æ‰©å±•ç”Ÿæˆç®—æ³•ï¼š

```typescript
public generateCustomTerrain(): void {
  for (let x = 0; x < size; x++) {
    for (let z = 0; z < size; z++) {
      const height = this.calculateHeight(x, z);
      // ... ç”Ÿæˆé€»è¾‘
    }
  }
}
```

### æ·»åŠ æ–°åŠŸèƒ½

1. åˆ›å»ºæ–°æ¨¡å—æ–‡ä»¶
2. åœ¨ä¸»å…¥å£ `main.ts` ä¸­é›†æˆ
3. æ›´æ–°ç±»å‹å®šä¹‰
4. æ·»åŠ UIç•Œé¢ï¼ˆå¦‚éœ€è¦ï¼‰
5. ç¼–å†™æµ‹è¯•ç”¨ä¾‹

## ğŸ® æ¸¸æˆå¾ªç¯

```typescript
private gameLoop(): void {
  requestAnimationFrame(() => this.gameLoop());

  // 1. æ›´æ–°ç©å®¶
  this.player.update();

  // 2. æ›´æ–°åœºæ™¯
  this.sceneManager.update();

  // 3. æ¸²æŸ“
  this.sceneManager.render();

  // 4. æ›´æ–°UI
  this.updateHUD();
}
```

## ğŸ” æ€§èƒ½ä¼˜åŒ–

### å½“å‰ä¼˜åŒ–ç­–ç•¥

1. **é¢å‰”é™¤**: åªæ¸²æŸ“å¯è§é¢ï¼Œå‡å°‘60%å‡ ä½•ä½“
2. **åˆ†å—åŠ è½½**: 32x32x32ä½“ç´ å—ï¼ŒæŒ‰éœ€åŠ è½½
3. **å®ä¾‹åŒ–æ¸²æŸ“**: ç›¸åŒæ–¹å—æ‰¹é‡æ¸²æŸ“

### è¿›ä¸€æ­¥ä¼˜åŒ–

1. **LOD (ç»†èŠ‚å±‚æ¬¡)**: æ ¹æ®è·ç¦»è°ƒæ•´ç»†èŠ‚
2. **é®æŒ¡å‰”é™¤**: ä¸æ¸²æŸ“è¢«é®æŒ¡çš„åŒºå—
3. **GPUå®ä¾‹åŒ–**: è¿›ä¸€æ­¥å‡å°‘ç»˜åˆ¶è°ƒç”¨
4. **Web Workers**: åå°çº¿ç¨‹å¤„ç†åœ°å½¢ç”Ÿæˆ

## ğŸ› è°ƒè¯•æŠ€å·§

### å¼€å¯è°ƒè¯•æ¨¡å¼

```typescript
// åœ¨ main.ts ä¸­å¯ç”¨
const DEBUG = true;

if (DEBUG) {
  console.log('è°ƒè¯•æ¨¡å¼å·²å¼€å¯');
}
```

### å¯è§†åŒ–å·¥å…·

- **Stats.js**: æ˜¾ç¤ºFPSå’Œæ€§èƒ½æŒ‡æ ‡
- **Three.js Inspector**: æµè§ˆå™¨æ‰©å±•
- **åˆ†å—å¯è§†åŒ–**: ç”¨ä¸åŒé¢œè‰²æ ‡è®°åŒºå—

### å¸¸è§é—®é¢˜

#### é—®é¢˜1: æ–¹å—æ— æ³•æ”¾ç½®
- æ£€æŸ¥å°„çº¿æ£€æµ‹è·ç¦»
- ç¡®è®¤åŒºå—å·²ç”Ÿæˆ
- éªŒè¯åæ ‡è®¡ç®—

#### é—®é¢˜2: æ€§èƒ½é—®é¢˜
- æ£€æŸ¥é¢å‰”é™¤æ˜¯å¦ç”Ÿæ•ˆ
- å‡å°‘åŒæ—¶æ¸²æŸ“çš„åŒºå—æ•°é‡
- å¯ç”¨WebGLæ€§èƒ½ç›‘æ§

#### é—®é¢˜3: ç¢°æ’æ£€æµ‹å¤±æ•ˆ
- è°ƒæ•´é‡åŠ›å€¼
- æ£€æŸ¥åœ°é¢é«˜åº¦è®¡ç®—
- éªŒè¯ç©å®¶ä½ç½®æ›´æ–°

## ğŸ“¦ æ„å»ºå’Œéƒ¨ç½²

### å¼€å‘æ¨¡å¼
```bash
npm run dev
```

### ç”Ÿäº§æ„å»º
```bash
npm run build
```

### é¢„è§ˆæ„å»ºç»“æœ
```bash
npm run preview
```

## ğŸ” æœ€ä½³å®è·µ

1. **ç±»å‹å®‰å…¨**: å§‹ç»ˆä½¿ç”¨TypeScriptç±»å‹æ£€æŸ¥
2. **æ€§èƒ½ç›‘æ§**: å®šæœŸæ£€æŸ¥FPSå’Œå†…å­˜ä½¿ç”¨
3. **ä»£ç å¤ç”¨**: åˆ›å»ºå¯å¤ç”¨çš„å·¥å…·å‡½æ•°
4. **é”™è¯¯å¤„ç†**: æ·»åŠ é€‚å½“çš„é”™è¯¯è¾¹ç•Œ
5. **æ–‡æ¡£æ›´æ–°**: åŠæ—¶æ›´æ–°ä»£ç æ³¨é‡Š

## ğŸ“š å‚è€ƒèµ„æº

- [Three.js å®˜æ–¹æ–‡æ¡£](https://threejs.org/docs/)
- [WebGL API å‚è€ƒ](https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API)
- [ä½“ç´ æ¸¸æˆå¼€å‘æŒ‡å—](https://voxeljs.com/)
- [Minecraft æ–¹å—ç™¾ç§‘](https://minecraft.fandom.com/wiki/Block)

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. åˆ›å»º Pull Request

---

**æ›´æ–°æ—¥æœŸ**: 2026-01-22
